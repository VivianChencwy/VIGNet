2025-11-22 23:27:39,550 - INFO - ================================================================================
2025-11-22 23:27:39,550 - INFO - TRIAL 8 - Task: RGS (FP1/FP2 only, no CV)
2025-11-22 23:27:39,550 - INFO - Log file: ./logs_fp_no_cv/trial8_RGS_20251122_213534.log
2025-11-22 23:27:39,550 - INFO - Start time: 2025-11-22 23:27:39
2025-11-22 23:27:39,550 - INFO - ================================================================================
2025-11-22 23:27:39,552 - INFO - START TRAINING - Task: RGS (FP1/FP2 only, no CV)
2025-11-22 23:27:39,552 - INFO - Learning rate: 0.005, Epochs: 200, Batches: 8
2025-11-22 23:27:39,552 - INFO - Data split: 70% train / 15% validation / 15% test
2025-11-22 23:27:39,552 - INFO - Loading dataset (FP1/FP2 channels only, fixed split)...
2025-11-22 23:27:39,564 - INFO - Dataset shapes - Train: (618, 2, 25, 1), Valid: (131, 2, 25, 1), Test: (136, 2, 25, 1)
2025-11-22 23:27:39,564 - INFO - Applied feature normalization (StandardScaler)
2025-11-22 23:27:39,565 - INFO - Initializing VIGNet-FP model (2 channels)...
2025-11-22 23:27:39,569 - INFO - Number of batch iterations per epoch: 77
2025-11-22 23:27:49,126 - INFO - Epoch: 1, Training Loss: 0.0388, Validation Loss: 0.0128
2025-11-22 23:27:49,132 - INFO -   → New best validation loss: 0.0128
2025-11-22 23:27:56,238 - INFO - Epoch: 2, Training Loss: 0.0128, Validation Loss: 0.0265
2025-11-22 23:28:05,620 - INFO - Epoch: 3, Training Loss: 0.0106, Validation Loss: 0.0091
2025-11-22 23:28:05,621 - INFO -   → New best validation loss: 0.0091
2025-11-22 23:28:15,952 - INFO - Epoch: 4, Training Loss: 0.0088, Validation Loss: 0.0091
2025-11-22 23:28:15,958 - INFO -   → New best validation loss: 0.0091
2025-11-22 23:28:25,092 - INFO - Epoch: 5, Training Loss: 0.0097, Validation Loss: 0.0078
2025-11-22 23:28:25,094 - INFO -   → New best validation loss: 0.0078
2025-11-22 23:28:33,903 - INFO - Epoch: 6, Training Loss: 0.0080, Validation Loss: 0.0086
2025-11-22 23:28:41,855 - INFO - Epoch: 7, Training Loss: 0.0075, Validation Loss: 0.0113
2025-11-22 23:28:51,197 - INFO - Epoch: 8, Training Loss: 0.0077, Validation Loss: 0.0091
2025-11-22 23:28:59,155 - INFO - Epoch: 9, Training Loss: 0.0070, Validation Loss: 0.0076
2025-11-22 23:28:59,160 - INFO -   → New best validation loss: 0.0076
2025-11-22 23:29:08,378 - INFO - Epoch: 10, Training Loss: 0.0070, Validation Loss: 0.0075
2025-11-22 23:29:08,379 - INFO -   → New best validation loss: 0.0075
2025-11-22 23:29:16,921 - INFO - Epoch: 11, Training Loss: 0.0075, Validation Loss: 0.0073
2025-11-22 23:29:16,922 - INFO -   → New best validation loss: 0.0073
2025-11-22 23:29:26,374 - INFO - Epoch: 12, Training Loss: 0.0070, Validation Loss: 0.0071
2025-11-22 23:29:26,378 - INFO -   → New best validation loss: 0.0071
2025-11-22 23:29:38,043 - INFO - Epoch: 13, Training Loss: 0.0067, Validation Loss: 0.0074
2025-11-22 23:29:47,692 - INFO - Epoch: 14, Training Loss: 0.0067, Validation Loss: 0.0083
2025-11-22 23:29:56,549 - INFO - Epoch: 15, Training Loss: 0.0067, Validation Loss: 0.0080
2025-11-22 23:30:05,632 - INFO - Epoch: 16, Training Loss: 0.0067, Validation Loss: 0.0067
2025-11-22 23:30:05,633 - INFO -   → New best validation loss: 0.0067
2025-11-22 23:30:13,540 - INFO - Epoch: 17, Training Loss: 0.0063, Validation Loss: 0.0066
2025-11-22 23:30:13,541 - INFO -   → New best validation loss: 0.0066
2025-11-22 23:30:23,191 - INFO - Epoch: 18, Training Loss: 0.0064, Validation Loss: 0.0067
2025-11-22 23:30:31,361 - INFO - Epoch: 19, Training Loss: 0.0061, Validation Loss: 0.0066
2025-11-22 23:30:31,366 - INFO -   → New best validation loss: 0.0066
2025-11-22 23:30:41,507 - INFO - Epoch: 20, Training Loss: 0.0060, Validation Loss: 0.0081
2025-11-22 23:30:50,666 - INFO - Epoch: 21, Training Loss: 0.0061, Validation Loss: 0.0068
2025-11-22 23:31:01,600 - INFO - Epoch: 22, Training Loss: 0.0062, Validation Loss: 0.0102
2025-11-22 23:31:10,820 - INFO - Epoch: 23, Training Loss: 0.0062, Validation Loss: 0.0064
2025-11-22 23:31:10,821 - INFO -   → New best validation loss: 0.0064
2025-11-22 23:31:20,287 - INFO - Epoch: 24, Training Loss: 0.0058, Validation Loss: 0.0058
2025-11-22 23:31:20,292 - INFO -   → New best validation loss: 0.0058
2025-11-22 23:31:31,809 - INFO - Epoch: 25, Training Loss: 0.0066, Validation Loss: 0.0066
2025-11-22 23:31:40,342 - INFO - Epoch: 26, Training Loss: 0.0061, Validation Loss: 0.0074
2025-11-22 23:31:48,093 - INFO - Epoch: 27, Training Loss: 0.0060, Validation Loss: 0.0055
2025-11-22 23:31:48,095 - INFO -   → New best validation loss: 0.0055
2025-11-22 23:31:58,833 - INFO - Epoch: 28, Training Loss: 0.0059, Validation Loss: 0.0089
2025-11-22 23:32:08,626 - INFO - Epoch: 29, Training Loss: 0.0056, Validation Loss: 0.0058
2025-11-22 23:32:17,529 - INFO - Epoch: 30, Training Loss: 0.0053, Validation Loss: 0.0058
2025-11-22 23:32:26,754 - INFO - Epoch: 31, Training Loss: 0.0050, Validation Loss: 0.0063
2025-11-22 23:32:36,222 - INFO - Epoch: 32, Training Loss: 0.0051, Validation Loss: 0.0058
2025-11-22 23:32:44,899 - INFO - Epoch: 33, Training Loss: 0.0052, Validation Loss: 0.0063
2025-11-22 23:32:53,919 - INFO - Epoch: 34, Training Loss: 0.0052, Validation Loss: 0.0052
2025-11-22 23:32:53,920 - INFO -   → New best validation loss: 0.0052
2025-11-22 23:33:04,260 - INFO - Epoch: 35, Training Loss: 0.0047, Validation Loss: 0.0052
2025-11-22 23:33:04,261 - INFO -   → New best validation loss: 0.0052
2025-11-22 23:33:16,319 - INFO - Epoch: 36, Training Loss: 0.0048, Validation Loss: 0.0052
2025-11-22 23:33:16,320 - INFO -   → New best validation loss: 0.0052
2025-11-22 23:33:25,106 - INFO - Epoch: 37, Training Loss: 0.0047, Validation Loss: 0.0049
2025-11-22 23:33:25,111 - INFO -   → New best validation loss: 0.0049
2025-11-22 23:33:33,848 - INFO - Epoch: 38, Training Loss: 0.0047, Validation Loss: 0.0056
2025-11-22 23:33:44,136 - INFO - Epoch: 39, Training Loss: 0.0044, Validation Loss: 0.0043
2025-11-22 23:33:44,142 - INFO -   → New best validation loss: 0.0043
2025-11-22 23:33:53,286 - INFO - Epoch: 40, Training Loss: 0.0040, Validation Loss: 0.0053
2025-11-22 23:34:02,358 - INFO - Epoch: 41, Training Loss: 0.0040, Validation Loss: 0.0046
2025-11-22 23:34:12,296 - INFO - Epoch: 42, Training Loss: 0.0046, Validation Loss: 0.0048
2025-11-22 23:34:22,415 - INFO - Epoch: 43, Training Loss: 0.0045, Validation Loss: 0.0040
2025-11-22 23:34:22,416 - INFO -   → New best validation loss: 0.0040
2025-11-22 23:34:31,443 - INFO - Epoch: 44, Training Loss: 0.0041, Validation Loss: 0.0039
2025-11-22 23:34:31,444 - INFO -   → New best validation loss: 0.0039
2025-11-22 23:34:38,437 - INFO - Epoch: 45, Training Loss: 0.0036, Validation Loss: 0.0044
2025-11-22 23:34:46,963 - INFO - Epoch: 46, Training Loss: 0.0037, Validation Loss: 0.0043
2025-11-22 23:34:55,504 - INFO - Epoch: 47, Training Loss: 0.0038, Validation Loss: 0.0042
2025-11-22 23:35:03,030 - INFO - Epoch: 48, Training Loss: 0.0037, Validation Loss: 0.0042
2025-11-22 23:35:10,092 - INFO - Epoch: 49, Training Loss: 0.0035, Validation Loss: 0.0042
2025-11-22 23:35:17,809 - INFO - Epoch: 50, Training Loss: 0.0037, Validation Loss: 0.0032
2025-11-22 23:35:17,811 - INFO -   → New best validation loss: 0.0032
2025-11-22 23:35:27,914 - INFO - Epoch: 51, Training Loss: 0.0033, Validation Loss: 0.0042
2025-11-22 23:35:35,326 - INFO - Epoch: 52, Training Loss: 0.0036, Validation Loss: 0.0032
2025-11-22 23:35:43,039 - INFO - Epoch: 53, Training Loss: 0.0034, Validation Loss: 0.0043
2025-11-22 23:35:54,345 - INFO - Epoch: 54, Training Loss: 0.0035, Validation Loss: 0.0035
2025-11-22 23:36:01,818 - INFO - Epoch: 55, Training Loss: 0.0036, Validation Loss: 0.0039
2025-11-22 23:36:11,471 - INFO - Epoch: 56, Training Loss: 0.0034, Validation Loss: 0.0043
2025-11-22 23:36:20,538 - INFO - Epoch: 57, Training Loss: 0.0033, Validation Loss: 0.0038
2025-11-22 23:36:29,740 - INFO - Epoch: 58, Training Loss: 0.0031, Validation Loss: 0.0039
2025-11-22 23:36:39,705 - INFO - Epoch: 59, Training Loss: 0.0032, Validation Loss: 0.0045
2025-11-22 23:36:47,789 - INFO - Epoch: 60, Training Loss: 0.0034, Validation Loss: 0.0024
2025-11-22 23:36:47,790 - INFO -   → New best validation loss: 0.0024
2025-11-22 23:36:53,998 - INFO - Epoch: 61, Training Loss: 0.0028, Validation Loss: 0.0029
2025-11-22 23:37:03,573 - INFO - Epoch: 62, Training Loss: 0.0030, Validation Loss: 0.0028
2025-11-22 23:37:12,069 - INFO - Epoch: 63, Training Loss: 0.0027, Validation Loss: 0.0028
2025-11-22 23:37:20,330 - INFO - Epoch: 64, Training Loss: 0.0025, Validation Loss: 0.0030
2025-11-22 23:37:29,946 - INFO - Epoch: 65, Training Loss: 0.0025, Validation Loss: 0.0027
2025-11-22 23:37:41,296 - INFO - Epoch: 66, Training Loss: 0.0026, Validation Loss: 0.0032
2025-11-22 23:37:47,583 - INFO - Epoch: 67, Training Loss: 0.0030, Validation Loss: 0.0027
2025-11-22 23:37:53,811 - INFO - Epoch: 68, Training Loss: 0.0028, Validation Loss: 0.0024
2025-11-22 23:38:05,532 - INFO - Epoch: 69, Training Loss: 0.0023, Validation Loss: 0.0025
2025-11-22 23:38:15,960 - INFO - Epoch: 70, Training Loss: 0.0024, Validation Loss: 0.0023
2025-11-22 23:38:15,961 - INFO -   → New best validation loss: 0.0023
2025-11-22 23:38:27,192 - INFO - Epoch: 71, Training Loss: 0.0021, Validation Loss: 0.0054
2025-11-22 23:38:35,539 - INFO - Epoch: 72, Training Loss: 0.0023, Validation Loss: 0.0022
2025-11-22 23:38:35,544 - INFO -   → New best validation loss: 0.0022
2025-11-22 23:38:44,183 - INFO - Epoch: 73, Training Loss: 0.0018, Validation Loss: 0.0018
2025-11-22 23:38:44,184 - INFO -   → New best validation loss: 0.0018
2025-11-22 23:38:51,590 - INFO - Epoch: 74, Training Loss: 0.0024, Validation Loss: 0.0025
2025-11-22 23:39:00,803 - INFO - Epoch: 75, Training Loss: 0.0024, Validation Loss: 0.0048
2025-11-22 23:39:10,058 - INFO - Epoch: 76, Training Loss: 0.0016, Validation Loss: 0.0025
2025-11-22 23:39:18,213 - INFO - Epoch: 77, Training Loss: 0.0017, Validation Loss: 0.0040
2025-11-22 23:39:25,143 - INFO - Epoch: 78, Training Loss: 0.0020, Validation Loss: 0.0021
2025-11-22 23:39:34,611 - INFO - Epoch: 79, Training Loss: 0.0019, Validation Loss: 0.0018
2025-11-22 23:39:34,612 - INFO -   → New best validation loss: 0.0018
2025-11-22 23:39:44,781 - INFO - Epoch: 80, Training Loss: 0.0015, Validation Loss: 0.0035
2025-11-22 23:39:55,206 - INFO - Epoch: 81, Training Loss: 0.0020, Validation Loss: 0.0021
2025-11-22 23:40:02,941 - INFO - Epoch: 82, Training Loss: 0.0019, Validation Loss: 0.0020
2025-11-22 23:40:13,048 - INFO - Epoch: 83, Training Loss: 0.0019, Validation Loss: 0.0021
2025-11-22 23:40:21,560 - INFO - Epoch: 84, Training Loss: 0.0020, Validation Loss: 0.0020
2025-11-22 23:40:30,009 - INFO - Epoch: 85, Training Loss: 0.0014, Validation Loss: 0.0012
2025-11-22 23:40:30,011 - INFO -   → New best validation loss: 0.0012
2025-11-22 23:40:39,124 - INFO - Epoch: 86, Training Loss: 0.0016, Validation Loss: 0.0019
2025-11-22 23:40:49,853 - INFO - Epoch: 87, Training Loss: 0.0017, Validation Loss: 0.0016
2025-11-22 23:40:57,155 - INFO - Epoch: 88, Training Loss: 0.0015, Validation Loss: 0.0022
2025-11-22 23:41:06,239 - INFO - Epoch: 89, Training Loss: 0.0016, Validation Loss: 0.0022
2025-11-22 23:41:15,313 - INFO - Epoch: 90, Training Loss: 0.0017, Validation Loss: 0.0022
2025-11-22 23:41:22,360 - INFO - Epoch: 91, Training Loss: 0.0016, Validation Loss: 0.0016
2025-11-22 23:41:32,211 - INFO - Epoch: 92, Training Loss: 0.0013, Validation Loss: 0.0014
2025-11-22 23:41:42,256 - INFO - Epoch: 93, Training Loss: 0.0014, Validation Loss: 0.0012
2025-11-22 23:41:52,492 - INFO - Epoch: 94, Training Loss: 0.0014, Validation Loss: 0.0023
2025-11-22 23:41:59,387 - INFO - Epoch: 95, Training Loss: 0.0020, Validation Loss: 0.0016
2025-11-22 23:42:10,525 - INFO - Epoch: 96, Training Loss: 0.0014, Validation Loss: 0.0016
2025-11-22 23:42:21,950 - INFO - Epoch: 97, Training Loss: 0.0015, Validation Loss: 0.0015
2025-11-22 23:42:30,845 - INFO - Epoch: 98, Training Loss: 0.0013, Validation Loss: 0.0011
2025-11-22 23:42:30,846 - INFO -   → New best validation loss: 0.0011
2025-11-22 23:42:40,491 - INFO - Epoch: 99, Training Loss: 0.0020, Validation Loss: 0.0019
2025-11-22 23:42:51,501 - INFO - Epoch: 100, Training Loss: 0.0014, Validation Loss: 0.0019
2025-11-22 23:43:00,188 - INFO - Epoch: 101, Training Loss: 0.0017, Validation Loss: 0.0011
2025-11-22 23:43:00,193 - INFO -   → New best validation loss: 0.0011
2025-11-22 23:43:09,156 - INFO - Epoch: 102, Training Loss: 0.0013, Validation Loss: 0.0016
2025-11-22 23:43:17,831 - INFO - Epoch: 103, Training Loss: 0.0015, Validation Loss: 0.0016
2025-11-22 23:43:28,517 - INFO - Epoch: 104, Training Loss: 0.0015, Validation Loss: 0.0020
2025-11-22 23:43:35,139 - INFO - Epoch: 105, Training Loss: 0.0013, Validation Loss: 0.0010
2025-11-22 23:43:35,140 - INFO -   → New best validation loss: 0.0010
2025-11-22 23:43:43,397 - INFO - Epoch: 106, Training Loss: 0.0013, Validation Loss: 0.0016
2025-11-22 23:43:54,033 - INFO - Epoch: 107, Training Loss: 0.0014, Validation Loss: 0.0019
2025-11-22 23:44:03,032 - INFO - Epoch: 108, Training Loss: 0.0017, Validation Loss: 0.0012
2025-11-22 23:44:10,164 - INFO - Epoch: 109, Training Loss: 0.0014, Validation Loss: 0.0016
2025-11-22 23:44:18,313 - INFO - Epoch: 110, Training Loss: 0.0014, Validation Loss: 0.0014
2025-11-22 23:44:27,682 - INFO - Epoch: 111, Training Loss: 0.0012, Validation Loss: 0.0013
2025-11-22 23:44:35,726 - INFO - Epoch: 112, Training Loss: 0.0012, Validation Loss: 0.0020
2025-11-22 23:44:46,421 - INFO - Epoch: 113, Training Loss: 0.0013, Validation Loss: 0.0015
2025-11-22 23:44:56,366 - INFO - Epoch: 114, Training Loss: 0.0014, Validation Loss: 0.0024
2025-11-22 23:45:05,724 - INFO - Epoch: 115, Training Loss: 0.0017, Validation Loss: 0.0013
2025-11-22 23:45:14,127 - INFO - Epoch: 116, Training Loss: 0.0013, Validation Loss: 0.0016
2025-11-22 23:45:25,015 - INFO - Epoch: 117, Training Loss: 0.0013, Validation Loss: 0.0009
2025-11-22 23:45:25,015 - INFO -   → New best validation loss: 0.0009
2025-11-22 23:45:35,566 - INFO - Epoch: 118, Training Loss: 0.0010, Validation Loss: 0.0009
2025-11-22 23:45:35,567 - INFO -   → New best validation loss: 0.0009
2025-11-22 23:45:43,241 - INFO - Epoch: 119, Training Loss: 0.0012, Validation Loss: 0.0014
2025-11-22 23:45:51,190 - INFO - Epoch: 120, Training Loss: 0.0013, Validation Loss: 0.0010
2025-11-22 23:46:01,000 - INFO - Epoch: 121, Training Loss: 0.0008, Validation Loss: 0.0017
2025-11-22 23:46:11,140 - INFO - Epoch: 122, Training Loss: 0.0013, Validation Loss: 0.0013
2025-11-22 23:46:23,044 - INFO - Epoch: 123, Training Loss: 0.0012, Validation Loss: 0.0016
2025-11-22 23:46:31,993 - INFO - Epoch: 124, Training Loss: 0.0013, Validation Loss: 0.0021
2025-11-22 23:46:42,770 - INFO - Epoch: 125, Training Loss: 0.0013, Validation Loss: 0.0013
2025-11-22 23:46:52,308 - INFO - Epoch: 126, Training Loss: 0.0015, Validation Loss: 0.0012
2025-11-22 23:47:02,650 - INFO - Epoch: 127, Training Loss: 0.0010, Validation Loss: 0.0010
2025-11-22 23:47:12,415 - INFO - Epoch: 128, Training Loss: 0.0013, Validation Loss: 0.0012
2025-11-22 23:47:20,268 - INFO - Epoch: 129, Training Loss: 0.0013, Validation Loss: 0.0017
2025-11-22 23:47:28,137 - INFO - Epoch: 130, Training Loss: 0.0013, Validation Loss: 0.0011
2025-11-22 23:47:38,968 - INFO - Epoch: 131, Training Loss: 0.0010, Validation Loss: 0.0010
2025-11-22 23:47:48,110 - INFO - Epoch: 132, Training Loss: 0.0014, Validation Loss: 0.0015
2025-11-22 23:47:58,593 - INFO - Epoch: 133, Training Loss: 0.0013, Validation Loss: 0.0013
2025-11-22 23:48:05,450 - INFO - Epoch: 134, Training Loss: 0.0012, Validation Loss: 0.0040
2025-11-22 23:48:12,324 - INFO - Epoch: 135, Training Loss: 0.0018, Validation Loss: 0.0016
2025-11-22 23:48:21,325 - INFO - Epoch: 136, Training Loss: 0.0014, Validation Loss: 0.0028
2025-11-22 23:48:30,681 - INFO - Epoch: 137, Training Loss: 0.0016, Validation Loss: 0.0017
2025-11-22 23:48:40,619 - INFO - Epoch: 138, Training Loss: 0.0015, Validation Loss: 0.0018
2025-11-22 23:48:40,619 - INFO - Early stopping triggered at epoch 138
2025-11-22 23:48:40,619 - INFO - Best validation loss: 0.0009
2025-11-22 23:48:40,623 - INFO - Restored best model weights
2025-11-22 23:48:40,623 - INFO - Starting model save process...
2025-11-22 23:48:40,623 - INFO - Creating models directory: ./logs_fp_no_cv/models
2025-11-22 23:48:40,624 - INFO - Models directory created/verified: ./logs_fp_no_cv/models
2025-11-22 23:48:40,624 - INFO - Attempting to save model to: ./logs_fp_no_cv/models/trial8_best_model
2025-11-22 23:48:40,731 - WARNING - Failed to save model in SavedModel format: in user code:

    File "/home/vivian/miniconda3/envs/seed/lib/python3.8/site-packages/keras/src/saving/legacy/saving_utils.py", line 147, in _wrapped_model  *
        outputs = model(*args, **kwargs)
    File "/home/vivian/miniconda3/envs/seed/lib/python3.8/site-packages/keras/src/utils/traceback_utils.py", line 70, in error_handler  **
        raise e.with_traceback(filtered_tb) from None
    File "/tmp/__autograph_generated_file3t0ck_8q.py", line 10, in tf__call
        att1 = ag__.converted_call(ag__.ld(self).MHRSSA, (ag__.ld(x), 10), None, fscope)
    File "/tmp/__autograph_generated_file2szops_9.py", line 41, in tf__MHRSSA
        ag__.for_stmt(ag__.converted_call(ag__.ld(range), (ag__.ld(out_filter),), None, fscope), None, loop_body, get_state_1, set_state_1, ('MHRSSA',), {'iterate_names': 'i'})
    File "/tmp/__autograph_generated_file2szops_9.py", line 21, in loop_body
        tmp = ag__.converted_call(ag__.converted_call(ag__.ld(tf).keras.layers.Conv2D, (ag__.ld(num_channel), (ag__.ld(num_channel), 1)), dict(kernel_regularizer=ag__.ld(self).regularizer, activation=None), fscope), (ag__.ld(x),), None, fscope)

    ValueError: Exception encountered when calling layer 'vignet_fp_7' (type vignet_fp).
    
    in user code:
    
        File "/home/vivian/eeg/SEED_VIG/VIGNet/network_fp.py", line 56, in call  *
            att1 = self.MHRSSA(x, 10)
        File "/home/vivian/eeg/SEED_VIG/VIGNet/network_fp.py", line 44, in MHRSSA  *
            tmp = tf.keras.layers.Conv2D(num_channel, (num_channel, 1), kernel_regularizer=self.regularizer, activation=None)(x)
        File "/home/vivian/miniconda3/envs/seed/lib/python3.8/site-packages/keras/src/utils/traceback_utils.py", line 70, in error_handler  **
            raise e.with_traceback(filtered_tb) from None
    
        ValueError: tf.function only supports singleton tf.Variables created on the first call. Make sure the tf.Variable is only created once or created outside tf.function. See https://www.tensorflow.org/guide/function#creating_tfvariables for more information.
    
    
    Call arguments received by layer 'vignet_fp_7' (type vignet_fp):
      • x=tf.Tensor(shape=(None, 2, 25, 1), dtype=float64)
      • training=False

2025-11-22 23:48:40,731 - WARNING - Traceback (most recent call last):
  File "experiment_fp_no_cv.py", line 261, in _save_model
    model.save(model_save_path, save_format='tf')
  File "/home/vivian/miniconda3/envs/seed/lib/python3.8/site-packages/keras/src/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_fileu3w_yla6.py", line 14, in tf___wrapped_model
    outputs = ag__.converted_call(ag__.ld(model), tuple(ag__.ld(args)), dict(**ag__.ld(kwargs)), fscope)
  File "/tmp/__autograph_generated_file3t0ck_8q.py", line 10, in tf__call
    att1 = ag__.converted_call(ag__.ld(self).MHRSSA, (ag__.ld(x), 10), None, fscope)
  File "/tmp/__autograph_generated_file2szops_9.py", line 41, in tf__MHRSSA
    ag__.for_stmt(ag__.converted_call(ag__.ld(range), (ag__.ld(out_filter),), None, fscope), None, loop_body, get_state_1, set_state_1, ('MHRSSA',), {'iterate_names': 'i'})
  File "/tmp/__autograph_generated_file2szops_9.py", line 21, in loop_body
    tmp = ag__.converted_call(ag__.converted_call(ag__.ld(tf).keras.layers.Conv2D, (ag__.ld(num_channel), (ag__.ld(num_channel), 1)), dict(kernel_regularizer=ag__.ld(self).regularizer, activation=None), fscope), (ag__.ld(x),), None, fscope)
ValueError: in user code:

    File "/home/vivian/miniconda3/envs/seed/lib/python3.8/site-packages/keras/src/saving/legacy/saving_utils.py", line 147, in _wrapped_model  *
        outputs = model(*args, **kwargs)
    File "/home/vivian/miniconda3/envs/seed/lib/python3.8/site-packages/keras/src/utils/traceback_utils.py", line 70, in error_handler  **
        raise e.with_traceback(filtered_tb) from None
    File "/tmp/__autograph_generated_file3t0ck_8q.py", line 10, in tf__call
        att1 = ag__.converted_call(ag__.ld(self).MHRSSA, (ag__.ld(x), 10), None, fscope)
    File "/tmp/__autograph_generated_file2szops_9.py", line 41, in tf__MHRSSA
        ag__.for_stmt(ag__.converted_call(ag__.ld(range), (ag__.ld(out_filter),), None, fscope), None, loop_body, get_state_1, set_state_1, ('MHRSSA',), {'iterate_names': 'i'})
    File "/tmp/__autograph_generated_file2szops_9.py", line 21, in loop_body
        tmp = ag__.converted_call(ag__.converted_call(ag__.ld(tf).keras.layers.Conv2D, (ag__.ld(num_channel), (ag__.ld(num_channel), 1)), dict(kernel_regularizer=ag__.ld(self).regularizer, activation=None), fscope), (ag__.ld(x),), None, fscope)

    ValueError: Exception encountered when calling layer 'vignet_fp_7' (type vignet_fp).
    
    in user code:
    
        File "/home/vivian/eeg/SEED_VIG/VIGNet/network_fp.py", line 56, in call  *
            att1 = self.MHRSSA(x, 10)
        File "/home/vivian/eeg/SEED_VIG/VIGNet/network_fp.py", line 44, in MHRSSA  *
            tmp = tf.keras.layers.Conv2D(num_channel, (num_channel, 1), kernel_regularizer=self.regularizer, activation=None)(x)
        File "/home/vivian/miniconda3/envs/seed/lib/python3.8/site-packages/keras/src/utils/traceback_utils.py", line 70, in error_handler  **
            raise e.with_traceback(filtered_tb) from None
    
        ValueError: tf.function only supports singleton tf.Variables created on the first call. Make sure the tf.Variable is only created once or created outside tf.function. See https://www.tensorflow.org/guide/function#creating_tfvariables for more information.
    
    
    Call arguments received by layer 'vignet_fp_7' (type vignet_fp):
      • x=tf.Tensor(shape=(None, 2, 25, 1), dtype=float64)
      • training=False


2025-11-22 23:48:40,731 - INFO - Attempting to save model weights to: ./logs_fp_no_cv/models/trial8_best_weights.h5
2025-11-22 23:48:40,737 - INFO - ✓ Saved model weights to: ./logs_fp_no_cv/models/trial8_best_weights.h5
2025-11-22 23:48:40,737 - INFO - Attempting to save scaler to: ./logs_fp_no_cv/models/trial8_scaler.pkl
2025-11-22 23:48:40,737 - INFO - ✓ Saved scaler to: ./logs_fp_no_cv/models/trial8_scaler.pkl
2025-11-22 23:48:40,737 - INFO - Attempting to save metadata to: ./logs_fp_no_cv/models/trial8_metadata.pkl
2025-11-22 23:48:40,737 - INFO - ✓ Saved model metadata to: ./logs_fp_no_cv/models/trial8_metadata.pkl
2025-11-22 23:48:40,737 - INFO - Model save process completed
2025-11-22 23:48:40,737 - INFO - 
============================================================
2025-11-22 23:48:40,737 - INFO - EVALUATION RESULTS
2025-11-22 23:48:40,737 - INFO - ============================================================
2025-11-22 23:48:40,785 - INFO - Validation Prediction Stats:
2025-11-22 23:48:40,785 - INFO -   Std: 0.234835, Range: 0.878954, Unique ratio: 0.7176
2025-11-22 23:48:40,786 - INFO - Validation Set - MSE: 0.001298, MAE: 0.027073, RMSE: 0.036028, Pearson Correlation: 0.988379 (p=0.000000)
2025-11-22 23:48:40,832 - INFO - Test Prediction Stats:
2025-11-22 23:48:40,832 - INFO -   Std: 0.232369, Range: 0.901323, Unique ratio: 0.6691
2025-11-22 23:48:40,833 - INFO - Test Set - MSE: 0.001454, MAE: 0.029300, RMSE: 0.038136, Pearson Correlation: 0.987329 (p=0.000000)
2025-11-22 23:48:40,833 - INFO - ============================================================

2025-11-22 23:48:40,833 - INFO - Trial completed successfully
2025-11-22 23:48:40,833 - INFO - ================================================================================
2025-11-22 23:48:40,833 - INFO - Trial 8 completed. End time: 2025-11-22 23:48:40
2025-11-22 23:48:40,833 - INFO - ================================================================================
