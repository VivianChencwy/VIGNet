2025-11-23 01:36:20,542 - INFO - ================================================================================
2025-11-23 01:36:20,542 - INFO - TRIAL 16 - Task: RGS (FP1/FP2 only, no CV)
2025-11-23 01:36:20,542 - INFO - Log file: ./logs_fp_no_cv/trial16_RGS_20251122_213534.log
2025-11-23 01:36:20,542 - INFO - Start time: 2025-11-23 01:36:20
2025-11-23 01:36:20,542 - INFO - ================================================================================
2025-11-23 01:36:20,548 - INFO - START TRAINING - Task: RGS (FP1/FP2 only, no CV)
2025-11-23 01:36:20,548 - INFO - Learning rate: 0.005, Epochs: 200, Batches: 8
2025-11-23 01:36:20,549 - INFO - Data split: 70% train / 15% validation / 15% test
2025-11-23 01:36:20,549 - INFO - Loading dataset (FP1/FP2 channels only, fixed split)...
2025-11-23 01:36:20,574 - INFO - Dataset shapes - Train: (617, 2, 25, 1), Valid: (131, 2, 25, 1), Test: (137, 2, 25, 1)
2025-11-23 01:36:20,574 - INFO - Applied feature normalization (StandardScaler)
2025-11-23 01:36:20,575 - INFO - Initializing VIGNet-FP model (2 channels)...
2025-11-23 01:36:20,580 - INFO - Number of batch iterations per epoch: 77
2025-11-23 01:36:31,852 - INFO - Epoch: 1, Training Loss: 0.1370, Validation Loss: 0.0834
2025-11-23 01:36:31,853 - INFO -   → New best validation loss: 0.0834
2025-11-23 01:36:40,550 - INFO - Epoch: 2, Training Loss: 0.0794, Validation Loss: 0.0922
2025-11-23 01:36:48,221 - INFO - Epoch: 3, Training Loss: 0.0654, Validation Loss: 0.0483
2025-11-23 01:36:48,227 - INFO -   → New best validation loss: 0.0483
2025-11-23 01:36:56,438 - INFO - Epoch: 4, Training Loss: 0.0322, Validation Loss: 0.0394
2025-11-23 01:36:56,439 - INFO -   → New best validation loss: 0.0394
2025-11-23 01:37:08,179 - INFO - Epoch: 5, Training Loss: 0.0318, Validation Loss: 0.0260
2025-11-23 01:37:08,184 - INFO -   → New best validation loss: 0.0260
2025-11-23 01:37:16,241 - INFO - Epoch: 6, Training Loss: 0.0236, Validation Loss: 0.0257
2025-11-23 01:37:16,242 - INFO -   → New best validation loss: 0.0257
2025-11-23 01:37:24,261 - INFO - Epoch: 7, Training Loss: 0.0225, Validation Loss: 0.0385
2025-11-23 01:37:33,012 - INFO - Epoch: 8, Training Loss: 0.0263, Validation Loss: 0.0585
2025-11-23 01:37:41,279 - INFO - Epoch: 9, Training Loss: 0.0236, Validation Loss: 0.0239
2025-11-23 01:37:41,280 - INFO -   → New best validation loss: 0.0239
2025-11-23 01:37:49,614 - INFO - Epoch: 10, Training Loss: 0.0202, Validation Loss: 0.0254
2025-11-23 01:37:58,459 - INFO - Epoch: 11, Training Loss: 0.0195, Validation Loss: 0.0200
2025-11-23 01:37:58,460 - INFO -   → New best validation loss: 0.0200
2025-11-23 01:38:05,743 - INFO - Epoch: 12, Training Loss: 0.0184, Validation Loss: 0.0216
2025-11-23 01:38:14,709 - INFO - Epoch: 13, Training Loss: 0.0177, Validation Loss: 0.0174
2025-11-23 01:38:14,710 - INFO -   → New best validation loss: 0.0174
2025-11-23 01:38:24,257 - INFO - Epoch: 14, Training Loss: 0.0183, Validation Loss: 0.0173
2025-11-23 01:38:24,258 - INFO -   → New best validation loss: 0.0173
2025-11-23 01:38:31,983 - INFO - Epoch: 15, Training Loss: 0.0184, Validation Loss: 0.0237
2025-11-23 01:38:40,785 - INFO - Epoch: 16, Training Loss: 0.0170, Validation Loss: 0.0163
2025-11-23 01:38:40,787 - INFO -   → New best validation loss: 0.0163
2025-11-23 01:38:49,259 - INFO - Epoch: 17, Training Loss: 0.0164, Validation Loss: 0.0159
2025-11-23 01:38:49,260 - INFO -   → New best validation loss: 0.0159
2025-11-23 01:38:58,981 - INFO - Epoch: 18, Training Loss: 0.0139, Validation Loss: 0.0156
2025-11-23 01:38:58,985 - INFO -   → New best validation loss: 0.0156
2025-11-23 01:39:09,347 - INFO - Epoch: 19, Training Loss: 0.0146, Validation Loss: 0.0169
2025-11-23 01:39:16,531 - INFO - Epoch: 20, Training Loss: 0.0134, Validation Loss: 0.0182
2025-11-23 01:39:21,906 - INFO - Epoch: 21, Training Loss: 0.0137, Validation Loss: 0.0217
2025-11-23 01:39:28,479 - INFO - Epoch: 22, Training Loss: 0.0144, Validation Loss: 0.0156
2025-11-23 01:39:28,483 - INFO -   → New best validation loss: 0.0156
2025-11-23 01:39:40,535 - INFO - Epoch: 23, Training Loss: 0.0142, Validation Loss: 0.0153
2025-11-23 01:39:40,536 - INFO -   → New best validation loss: 0.0153
2025-11-23 01:39:49,714 - INFO - Epoch: 24, Training Loss: 0.0124, Validation Loss: 0.0199
2025-11-23 01:39:56,843 - INFO - Epoch: 25, Training Loss: 0.0125, Validation Loss: 0.0131
2025-11-23 01:39:56,845 - INFO -   → New best validation loss: 0.0131
2025-11-23 01:40:04,921 - INFO - Epoch: 26, Training Loss: 0.0115, Validation Loss: 0.0158
2025-11-23 01:40:16,147 - INFO - Epoch: 27, Training Loss: 0.0114, Validation Loss: 0.0191
2025-11-23 01:40:25,501 - INFO - Epoch: 28, Training Loss: 0.0114, Validation Loss: 0.0138
2025-11-23 01:40:34,805 - INFO - Epoch: 29, Training Loss: 0.0097, Validation Loss: 0.0099
2025-11-23 01:40:34,808 - INFO -   → New best validation loss: 0.0099
2025-11-23 01:40:43,654 - INFO - Epoch: 30, Training Loss: 0.0087, Validation Loss: 0.0121
2025-11-23 01:40:49,785 - INFO - Epoch: 31, Training Loss: 0.0092, Validation Loss: 0.0104
2025-11-23 01:40:59,260 - INFO - Epoch: 32, Training Loss: 0.0074, Validation Loss: 0.0073
2025-11-23 01:40:59,261 - INFO -   → New best validation loss: 0.0073
2025-11-23 01:41:09,936 - INFO - Epoch: 33, Training Loss: 0.0061, Validation Loss: 0.0054
2025-11-23 01:41:09,937 - INFO -   → New best validation loss: 0.0054
2025-11-23 01:41:19,765 - INFO - Epoch: 34, Training Loss: 0.0061, Validation Loss: 0.0063
2025-11-23 01:41:28,366 - INFO - Epoch: 35, Training Loss: 0.0061, Validation Loss: 0.0106
2025-11-23 01:41:36,882 - INFO - Epoch: 36, Training Loss: 0.0057, Validation Loss: 0.0059
2025-11-23 01:41:45,386 - INFO - Epoch: 37, Training Loss: 0.0062, Validation Loss: 0.0060
2025-11-23 01:41:55,088 - INFO - Epoch: 38, Training Loss: 0.0050, Validation Loss: 0.0075
2025-11-23 01:42:02,789 - INFO - Epoch: 39, Training Loss: 0.0046, Validation Loss: 0.0061
2025-11-23 01:42:10,693 - INFO - Epoch: 40, Training Loss: 0.0043, Validation Loss: 0.0049
2025-11-23 01:42:10,694 - INFO -   → New best validation loss: 0.0049
2025-11-23 01:42:19,518 - INFO - Epoch: 41, Training Loss: 0.0039, Validation Loss: 0.0046
2025-11-23 01:42:19,519 - INFO -   → New best validation loss: 0.0046
2025-11-23 01:42:26,429 - INFO - Epoch: 42, Training Loss: 0.0039, Validation Loss: 0.0030
2025-11-23 01:42:26,430 - INFO -   → New best validation loss: 0.0030
2025-11-23 01:42:35,261 - INFO - Epoch: 43, Training Loss: 0.0039, Validation Loss: 0.0050
2025-11-23 01:42:43,082 - INFO - Epoch: 44, Training Loss: 0.0038, Validation Loss: 0.0036
2025-11-23 01:42:51,779 - INFO - Epoch: 45, Training Loss: 0.0044, Validation Loss: 0.0025
2025-11-23 01:42:51,780 - INFO -   → New best validation loss: 0.0025
2025-11-23 01:42:58,010 - INFO - Epoch: 46, Training Loss: 0.0036, Validation Loss: 0.0035
2025-11-23 01:43:06,240 - INFO - Epoch: 47, Training Loss: 0.0031, Validation Loss: 0.0033
2025-11-23 01:43:14,065 - INFO - Epoch: 48, Training Loss: 0.0030, Validation Loss: 0.0018
2025-11-23 01:43:14,066 - INFO -   → New best validation loss: 0.0018
2025-11-23 01:43:24,790 - INFO - Epoch: 49, Training Loss: 0.0028, Validation Loss: 0.0030
2025-11-23 01:43:34,383 - INFO - Epoch: 50, Training Loss: 0.0027, Validation Loss: 0.0027
2025-11-23 01:43:44,171 - INFO - Epoch: 51, Training Loss: 0.0032, Validation Loss: 0.0022
2025-11-23 01:43:54,689 - INFO - Epoch: 52, Training Loss: 0.0030, Validation Loss: 0.0033
2025-11-23 01:44:05,757 - INFO - Epoch: 53, Training Loss: 0.0025, Validation Loss: 0.0022
2025-11-23 01:44:16,046 - INFO - Epoch: 54, Training Loss: 0.0028, Validation Loss: 0.0012
2025-11-23 01:44:16,047 - INFO -   → New best validation loss: 0.0012
2025-11-23 01:44:22,845 - INFO - Epoch: 55, Training Loss: 0.0026, Validation Loss: 0.0023
2025-11-23 01:44:31,018 - INFO - Epoch: 56, Training Loss: 0.0026, Validation Loss: 0.0027
2025-11-23 01:44:40,259 - INFO - Epoch: 57, Training Loss: 0.0027, Validation Loss: 0.0031
2025-11-23 01:44:51,293 - INFO - Epoch: 58, Training Loss: 0.0025, Validation Loss: 0.0021
2025-11-23 01:44:58,046 - INFO - Epoch: 59, Training Loss: 0.0029, Validation Loss: 0.0024
2025-11-23 01:45:07,908 - INFO - Epoch: 60, Training Loss: 0.0021, Validation Loss: 0.0031
2025-11-23 01:45:18,227 - INFO - Epoch: 61, Training Loss: 0.0029, Validation Loss: 0.0037
2025-11-23 01:45:28,209 - INFO - Epoch: 62, Training Loss: 0.0021, Validation Loss: 0.0016
2025-11-23 01:45:36,332 - INFO - Epoch: 63, Training Loss: 0.0026, Validation Loss: 0.0013
2025-11-23 01:45:45,525 - INFO - Epoch: 64, Training Loss: 0.0018, Validation Loss: 0.0016
2025-11-23 01:45:53,892 - INFO - Epoch: 65, Training Loss: 0.0027, Validation Loss: 0.0021
2025-11-23 01:46:03,278 - INFO - Epoch: 66, Training Loss: 0.0022, Validation Loss: 0.0027
2025-11-23 01:46:13,220 - INFO - Epoch: 67, Training Loss: 0.0023, Validation Loss: 0.0027
2025-11-23 01:46:19,723 - INFO - Epoch: 68, Training Loss: 0.0020, Validation Loss: 0.0044
2025-11-23 01:46:29,235 - INFO - Epoch: 69, Training Loss: 0.0022, Validation Loss: 0.0023
2025-11-23 01:46:40,406 - INFO - Epoch: 70, Training Loss: 0.0024, Validation Loss: 0.0021
2025-11-23 01:46:50,852 - INFO - Epoch: 71, Training Loss: 0.0020, Validation Loss: 0.0013
2025-11-23 01:46:59,350 - INFO - Epoch: 72, Training Loss: 0.0027, Validation Loss: 0.0030
2025-11-23 01:47:09,406 - INFO - Epoch: 73, Training Loss: 0.0025, Validation Loss: 0.0021
2025-11-23 01:47:17,742 - INFO - Epoch: 74, Training Loss: 0.0023, Validation Loss: 0.0029
2025-11-23 01:47:17,742 - INFO - Early stopping triggered at epoch 74
2025-11-23 01:47:17,742 - INFO - Best validation loss: 0.0012
2025-11-23 01:47:17,747 - INFO - Restored best model weights
2025-11-23 01:47:17,747 - INFO - Starting model save process...
2025-11-23 01:47:17,747 - INFO - Creating models directory: ./logs_fp_no_cv/models
2025-11-23 01:47:17,747 - INFO - Models directory created/verified: ./logs_fp_no_cv/models
2025-11-23 01:47:17,747 - INFO - Attempting to save model to: ./logs_fp_no_cv/models/trial16_best_model
2025-11-23 01:47:17,855 - WARNING - Failed to save model in SavedModel format: in user code:

    File "/home/vivian/miniconda3/envs/seed/lib/python3.8/site-packages/keras/src/saving/legacy/saving_utils.py", line 147, in _wrapped_model  *
        outputs = model(*args, **kwargs)
    File "/home/vivian/miniconda3/envs/seed/lib/python3.8/site-packages/keras/src/utils/traceback_utils.py", line 70, in error_handler  **
        raise e.with_traceback(filtered_tb) from None
    File "/tmp/__autograph_generated_file3t0ck_8q.py", line 10, in tf__call
        att1 = ag__.converted_call(ag__.ld(self).MHRSSA, (ag__.ld(x), 10), None, fscope)
    File "/tmp/__autograph_generated_file2szops_9.py", line 41, in tf__MHRSSA
        ag__.for_stmt(ag__.converted_call(ag__.ld(range), (ag__.ld(out_filter),), None, fscope), None, loop_body, get_state_1, set_state_1, ('MHRSSA',), {'iterate_names': 'i'})
    File "/tmp/__autograph_generated_file2szops_9.py", line 21, in loop_body
        tmp = ag__.converted_call(ag__.converted_call(ag__.ld(tf).keras.layers.Conv2D, (ag__.ld(num_channel), (ag__.ld(num_channel), 1)), dict(kernel_regularizer=ag__.ld(self).regularizer, activation=None), fscope), (ag__.ld(x),), None, fscope)

    ValueError: Exception encountered when calling layer 'vignet_fp_15' (type vignet_fp).
    
    in user code:
    
        File "/home/vivian/eeg/SEED_VIG/VIGNet/network_fp.py", line 56, in call  *
            att1 = self.MHRSSA(x, 10)
        File "/home/vivian/eeg/SEED_VIG/VIGNet/network_fp.py", line 44, in MHRSSA  *
            tmp = tf.keras.layers.Conv2D(num_channel, (num_channel, 1), kernel_regularizer=self.regularizer, activation=None)(x)
        File "/home/vivian/miniconda3/envs/seed/lib/python3.8/site-packages/keras/src/utils/traceback_utils.py", line 70, in error_handler  **
            raise e.with_traceback(filtered_tb) from None
    
        ValueError: tf.function only supports singleton tf.Variables created on the first call. Make sure the tf.Variable is only created once or created outside tf.function. See https://www.tensorflow.org/guide/function#creating_tfvariables for more information.
    
    
    Call arguments received by layer 'vignet_fp_15' (type vignet_fp):
      • x=tf.Tensor(shape=(None, 2, 25, 1), dtype=float64)
      • training=False

2025-11-23 01:47:17,855 - WARNING - Traceback (most recent call last):
  File "experiment_fp_no_cv.py", line 261, in _save_model
    model.save(model_save_path, save_format='tf')
  File "/home/vivian/miniconda3/envs/seed/lib/python3.8/site-packages/keras/src/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_fileu3w_yla6.py", line 14, in tf___wrapped_model
    outputs = ag__.converted_call(ag__.ld(model), tuple(ag__.ld(args)), dict(**ag__.ld(kwargs)), fscope)
  File "/tmp/__autograph_generated_file3t0ck_8q.py", line 10, in tf__call
    att1 = ag__.converted_call(ag__.ld(self).MHRSSA, (ag__.ld(x), 10), None, fscope)
  File "/tmp/__autograph_generated_file2szops_9.py", line 41, in tf__MHRSSA
    ag__.for_stmt(ag__.converted_call(ag__.ld(range), (ag__.ld(out_filter),), None, fscope), None, loop_body, get_state_1, set_state_1, ('MHRSSA',), {'iterate_names': 'i'})
  File "/tmp/__autograph_generated_file2szops_9.py", line 21, in loop_body
    tmp = ag__.converted_call(ag__.converted_call(ag__.ld(tf).keras.layers.Conv2D, (ag__.ld(num_channel), (ag__.ld(num_channel), 1)), dict(kernel_regularizer=ag__.ld(self).regularizer, activation=None), fscope), (ag__.ld(x),), None, fscope)
ValueError: in user code:

    File "/home/vivian/miniconda3/envs/seed/lib/python3.8/site-packages/keras/src/saving/legacy/saving_utils.py", line 147, in _wrapped_model  *
        outputs = model(*args, **kwargs)
    File "/home/vivian/miniconda3/envs/seed/lib/python3.8/site-packages/keras/src/utils/traceback_utils.py", line 70, in error_handler  **
        raise e.with_traceback(filtered_tb) from None
    File "/tmp/__autograph_generated_file3t0ck_8q.py", line 10, in tf__call
        att1 = ag__.converted_call(ag__.ld(self).MHRSSA, (ag__.ld(x), 10), None, fscope)
    File "/tmp/__autograph_generated_file2szops_9.py", line 41, in tf__MHRSSA
        ag__.for_stmt(ag__.converted_call(ag__.ld(range), (ag__.ld(out_filter),), None, fscope), None, loop_body, get_state_1, set_state_1, ('MHRSSA',), {'iterate_names': 'i'})
    File "/tmp/__autograph_generated_file2szops_9.py", line 21, in loop_body
        tmp = ag__.converted_call(ag__.converted_call(ag__.ld(tf).keras.layers.Conv2D, (ag__.ld(num_channel), (ag__.ld(num_channel), 1)), dict(kernel_regularizer=ag__.ld(self).regularizer, activation=None), fscope), (ag__.ld(x),), None, fscope)

    ValueError: Exception encountered when calling layer 'vignet_fp_15' (type vignet_fp).
    
    in user code:
    
        File "/home/vivian/eeg/SEED_VIG/VIGNet/network_fp.py", line 56, in call  *
            att1 = self.MHRSSA(x, 10)
        File "/home/vivian/eeg/SEED_VIG/VIGNet/network_fp.py", line 44, in MHRSSA  *
            tmp = tf.keras.layers.Conv2D(num_channel, (num_channel, 1), kernel_regularizer=self.regularizer, activation=None)(x)
        File "/home/vivian/miniconda3/envs/seed/lib/python3.8/site-packages/keras/src/utils/traceback_utils.py", line 70, in error_handler  **
            raise e.with_traceback(filtered_tb) from None
    
        ValueError: tf.function only supports singleton tf.Variables created on the first call. Make sure the tf.Variable is only created once or created outside tf.function. See https://www.tensorflow.org/guide/function#creating_tfvariables for more information.
    
    
    Call arguments received by layer 'vignet_fp_15' (type vignet_fp):
      • x=tf.Tensor(shape=(None, 2, 25, 1), dtype=float64)
      • training=False


2025-11-23 01:47:17,855 - INFO - Attempting to save model weights to: ./logs_fp_no_cv/models/trial16_best_weights.h5
2025-11-23 01:47:17,862 - INFO - ✓ Saved model weights to: ./logs_fp_no_cv/models/trial16_best_weights.h5
2025-11-23 01:47:17,862 - INFO - Attempting to save scaler to: ./logs_fp_no_cv/models/trial16_scaler.pkl
2025-11-23 01:47:17,862 - INFO - ✓ Saved scaler to: ./logs_fp_no_cv/models/trial16_scaler.pkl
2025-11-23 01:47:17,862 - INFO - Attempting to save metadata to: ./logs_fp_no_cv/models/trial16_metadata.pkl
2025-11-23 01:47:17,862 - INFO - ✓ Saved model metadata to: ./logs_fp_no_cv/models/trial16_metadata.pkl
2025-11-23 01:47:17,862 - INFO - Model save process completed
2025-11-23 01:47:17,862 - INFO - 
============================================================
2025-11-23 01:47:17,862 - INFO - EVALUATION RESULTS
2025-11-23 01:47:17,862 - INFO - ============================================================
2025-11-23 01:47:17,909 - INFO - Validation Prediction Stats:
2025-11-23 01:47:17,909 - INFO -   Std: 0.312519, Range: 0.956847, Unique ratio: 0.7405
2025-11-23 01:47:17,910 - INFO - Validation Set - MSE: 0.001825, MAE: 0.032727, RMSE: 0.042724, Pearson Correlation: 0.993008 (p=0.000000)
2025-11-23 01:47:17,954 - INFO - Test Prediction Stats:
2025-11-23 01:47:17,954 - INFO -   Std: 0.307556, Range: 0.972878, Unique ratio: 0.7737
2025-11-23 01:47:17,954 - INFO - Test Set - MSE: 0.002534, MAE: 0.038512, RMSE: 0.050343, Pearson Correlation: 0.987841 (p=0.000000)
2025-11-23 01:47:17,954 - INFO - ============================================================

2025-11-23 01:47:17,954 - INFO - Trial completed successfully
2025-11-23 01:47:17,955 - INFO - ================================================================================
2025-11-23 01:47:17,955 - INFO - Trial 16 completed. End time: 2025-11-23 01:47:17
2025-11-23 01:47:17,955 - INFO - ================================================================================
