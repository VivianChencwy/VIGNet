2025-11-23 00:32:09,056 - INFO - ================================================================================
2025-11-23 00:32:09,056 - INFO - TRIAL 12 - Task: RGS (FP1/FP2 only, no CV)
2025-11-23 00:32:09,056 - INFO - Log file: ./logs_fp_no_cv/trial12_RGS_20251122_213534.log
2025-11-23 00:32:09,056 - INFO - Start time: 2025-11-23 00:32:09
2025-11-23 00:32:09,056 - INFO - ================================================================================
2025-11-23 00:32:09,062 - INFO - START TRAINING - Task: RGS (FP1/FP2 only, no CV)
2025-11-23 00:32:09,062 - INFO - Learning rate: 0.005, Epochs: 200, Batches: 8
2025-11-23 00:32:09,062 - INFO - Data split: 70% train / 15% validation / 15% test
2025-11-23 00:32:09,062 - INFO - Loading dataset (FP1/FP2 channels only, fixed split)...
2025-11-23 00:32:09,083 - INFO - Dataset shapes - Train: (618, 2, 25, 1), Valid: (131, 2, 25, 1), Test: (136, 2, 25, 1)
2025-11-23 00:32:09,083 - INFO - Applied feature normalization (StandardScaler)
2025-11-23 00:32:09,084 - INFO - Initializing VIGNet-FP model (2 channels)...
2025-11-23 00:32:09,089 - INFO - Number of batch iterations per epoch: 77
2025-11-23 00:32:16,252 - INFO - Epoch: 1, Training Loss: 0.0961, Validation Loss: 0.0385
2025-11-23 00:32:16,253 - INFO -   → New best validation loss: 0.0385
2025-11-23 00:32:25,626 - INFO - Epoch: 2, Training Loss: 0.0174, Validation Loss: 0.0089
2025-11-23 00:32:25,627 - INFO -   → New best validation loss: 0.0089
2025-11-23 00:32:35,218 - INFO - Epoch: 3, Training Loss: 0.0139, Validation Loss: 0.0183
2025-11-23 00:32:45,069 - INFO - Epoch: 4, Training Loss: 0.0121, Validation Loss: 0.0059
2025-11-23 00:32:45,070 - INFO -   → New best validation loss: 0.0059
2025-11-23 00:32:53,512 - INFO - Epoch: 5, Training Loss: 0.0101, Validation Loss: 0.0089
2025-11-23 00:33:03,516 - INFO - Epoch: 6, Training Loss: 0.0116, Validation Loss: 0.0069
2025-11-23 00:33:11,850 - INFO - Epoch: 7, Training Loss: 0.0100, Validation Loss: 0.0140
2025-11-23 00:33:21,852 - INFO - Epoch: 8, Training Loss: 0.0101, Validation Loss: 0.0143
2025-11-23 00:33:32,502 - INFO - Epoch: 9, Training Loss: 0.0110, Validation Loss: 0.0080
2025-11-23 00:33:42,136 - INFO - Epoch: 10, Training Loss: 0.0089, Validation Loss: 0.0073
2025-11-23 00:33:51,445 - INFO - Epoch: 11, Training Loss: 0.0112, Validation Loss: 0.0105
2025-11-23 00:34:01,171 - INFO - Epoch: 12, Training Loss: 0.0096, Validation Loss: 0.0082
2025-11-23 00:34:09,772 - INFO - Epoch: 13, Training Loss: 0.0084, Validation Loss: 0.0055
2025-11-23 00:34:09,778 - INFO -   → New best validation loss: 0.0055
2025-11-23 00:34:18,369 - INFO - Epoch: 14, Training Loss: 0.0083, Validation Loss: 0.0118
2025-11-23 00:34:26,098 - INFO - Epoch: 15, Training Loss: 0.0091, Validation Loss: 0.0073
2025-11-23 00:34:32,654 - INFO - Epoch: 16, Training Loss: 0.0078, Validation Loss: 0.0053
2025-11-23 00:34:32,658 - INFO -   → New best validation loss: 0.0053
2025-11-23 00:34:42,818 - INFO - Epoch: 17, Training Loss: 0.0085, Validation Loss: 0.0064
2025-11-23 00:34:51,757 - INFO - Epoch: 18, Training Loss: 0.0078, Validation Loss: 0.0055
2025-11-23 00:34:58,570 - INFO - Epoch: 19, Training Loss: 0.0087, Validation Loss: 0.0069
2025-11-23 00:35:08,340 - INFO - Epoch: 20, Training Loss: 0.0073, Validation Loss: 0.0071
2025-11-23 00:35:19,132 - INFO - Epoch: 21, Training Loss: 0.0068, Validation Loss: 0.0062
2025-11-23 00:35:26,929 - INFO - Epoch: 22, Training Loss: 0.0073, Validation Loss: 0.0068
2025-11-23 00:35:34,109 - INFO - Epoch: 23, Training Loss: 0.0087, Validation Loss: 0.0088
2025-11-23 00:35:44,435 - INFO - Epoch: 24, Training Loss: 0.0082, Validation Loss: 0.0070
2025-11-23 00:35:51,972 - INFO - Epoch: 25, Training Loss: 0.0073, Validation Loss: 0.0061
2025-11-23 00:35:59,794 - INFO - Epoch: 26, Training Loss: 0.0067, Validation Loss: 0.0069
2025-11-23 00:36:05,759 - INFO - Epoch: 27, Training Loss: 0.0080, Validation Loss: 0.0059
2025-11-23 00:36:12,536 - INFO - Epoch: 28, Training Loss: 0.0069, Validation Loss: 0.0053
2025-11-23 00:36:12,537 - INFO -   → New best validation loss: 0.0053
2025-11-23 00:36:19,964 - INFO - Epoch: 29, Training Loss: 0.0080, Validation Loss: 0.0108
2025-11-23 00:36:28,356 - INFO - Epoch: 30, Training Loss: 0.0078, Validation Loss: 0.0072
2025-11-23 00:36:37,774 - INFO - Epoch: 31, Training Loss: 0.0068, Validation Loss: 0.0055
2025-11-23 00:36:45,696 - INFO - Epoch: 32, Training Loss: 0.0072, Validation Loss: 0.0062
2025-11-23 00:36:53,190 - INFO - Epoch: 33, Training Loss: 0.0060, Validation Loss: 0.0077
2025-11-23 00:37:00,907 - INFO - Epoch: 34, Training Loss: 0.0064, Validation Loss: 0.0054
2025-11-23 00:37:07,773 - INFO - Epoch: 35, Training Loss: 0.0065, Validation Loss: 0.0050
2025-11-23 00:37:07,776 - INFO -   → New best validation loss: 0.0050
2025-11-23 00:37:17,511 - INFO - Epoch: 36, Training Loss: 0.0062, Validation Loss: 0.0050
2025-11-23 00:37:25,641 - INFO - Epoch: 37, Training Loss: 0.0072, Validation Loss: 0.0084
2025-11-23 00:37:37,106 - INFO - Epoch: 38, Training Loss: 0.0052, Validation Loss: 0.0054
2025-11-23 00:37:47,657 - INFO - Epoch: 39, Training Loss: 0.0059, Validation Loss: 0.0058
2025-11-23 00:37:55,679 - INFO - Epoch: 40, Training Loss: 0.0060, Validation Loss: 0.0075
2025-11-23 00:38:05,178 - INFO - Epoch: 41, Training Loss: 0.0053, Validation Loss: 0.0050
2025-11-23 00:38:15,113 - INFO - Epoch: 42, Training Loss: 0.0057, Validation Loss: 0.0067
2025-11-23 00:38:24,605 - INFO - Epoch: 43, Training Loss: 0.0055, Validation Loss: 0.0095
2025-11-23 00:38:33,501 - INFO - Epoch: 44, Training Loss: 0.0056, Validation Loss: 0.0061
2025-11-23 00:38:42,247 - INFO - Epoch: 45, Training Loss: 0.0050, Validation Loss: 0.0054
2025-11-23 00:38:52,760 - INFO - Epoch: 46, Training Loss: 0.0045, Validation Loss: 0.0049
2025-11-23 00:38:52,764 - INFO -   → New best validation loss: 0.0049
2025-11-23 00:39:03,652 - INFO - Epoch: 47, Training Loss: 0.0053, Validation Loss: 0.0058
2025-11-23 00:39:13,477 - INFO - Epoch: 48, Training Loss: 0.0050, Validation Loss: 0.0054
2025-11-23 00:39:22,315 - INFO - Epoch: 49, Training Loss: 0.0045, Validation Loss: 0.0066
2025-11-23 00:39:29,847 - INFO - Epoch: 50, Training Loss: 0.0048, Validation Loss: 0.0042
2025-11-23 00:39:29,853 - INFO -   → New best validation loss: 0.0042
2025-11-23 00:39:38,341 - INFO - Epoch: 51, Training Loss: 0.0040, Validation Loss: 0.0046
2025-11-23 00:39:46,865 - INFO - Epoch: 52, Training Loss: 0.0050, Validation Loss: 0.0049
2025-11-23 00:39:56,973 - INFO - Epoch: 53, Training Loss: 0.0038, Validation Loss: 0.0044
2025-11-23 00:40:05,738 - INFO - Epoch: 54, Training Loss: 0.0046, Validation Loss: 0.0047
2025-11-23 00:40:14,343 - INFO - Epoch: 55, Training Loss: 0.0039, Validation Loss: 0.0035
2025-11-23 00:40:14,346 - INFO -   → New best validation loss: 0.0035
2025-11-23 00:40:21,847 - INFO - Epoch: 56, Training Loss: 0.0049, Validation Loss: 0.0066
2025-11-23 00:40:31,018 - INFO - Epoch: 57, Training Loss: 0.0044, Validation Loss: 0.0037
2025-11-23 00:40:41,221 - INFO - Epoch: 58, Training Loss: 0.0038, Validation Loss: 0.0078
2025-11-23 00:40:50,070 - INFO - Epoch: 59, Training Loss: 0.0038, Validation Loss: 0.0062
2025-11-23 00:40:59,131 - INFO - Epoch: 60, Training Loss: 0.0039, Validation Loss: 0.0039
2025-11-23 00:41:07,084 - INFO - Epoch: 61, Training Loss: 0.0038, Validation Loss: 0.0031
2025-11-23 00:41:07,085 - INFO -   → New best validation loss: 0.0031
2025-11-23 00:41:16,394 - INFO - Epoch: 62, Training Loss: 0.0037, Validation Loss: 0.0041
2025-11-23 00:41:22,673 - INFO - Epoch: 63, Training Loss: 0.0035, Validation Loss: 0.0031
2025-11-23 00:41:30,284 - INFO - Epoch: 64, Training Loss: 0.0032, Validation Loss: 0.0037
2025-11-23 00:41:39,219 - INFO - Epoch: 65, Training Loss: 0.0034, Validation Loss: 0.0034
2025-11-23 00:41:48,530 - INFO - Epoch: 66, Training Loss: 0.0034, Validation Loss: 0.0032
2025-11-23 00:41:58,271 - INFO - Epoch: 67, Training Loss: 0.0035, Validation Loss: 0.0033
2025-11-23 00:42:05,930 - INFO - Epoch: 68, Training Loss: 0.0032, Validation Loss: 0.0056
2025-11-23 00:42:16,476 - INFO - Epoch: 69, Training Loss: 0.0032, Validation Loss: 0.0034
2025-11-23 00:42:23,720 - INFO - Epoch: 70, Training Loss: 0.0035, Validation Loss: 0.0032
2025-11-23 00:42:32,606 - INFO - Epoch: 71, Training Loss: 0.0033, Validation Loss: 0.0042
2025-11-23 00:42:43,841 - INFO - Epoch: 72, Training Loss: 0.0030, Validation Loss: 0.0033
2025-11-23 00:42:53,973 - INFO - Epoch: 73, Training Loss: 0.0035, Validation Loss: 0.0041
2025-11-23 00:43:01,955 - INFO - Epoch: 74, Training Loss: 0.0031, Validation Loss: 0.0035
2025-11-23 00:43:10,985 - INFO - Epoch: 75, Training Loss: 0.0030, Validation Loss: 0.0037
2025-11-23 00:43:21,618 - INFO - Epoch: 76, Training Loss: 0.0028, Validation Loss: 0.0042
2025-11-23 00:43:30,281 - INFO - Epoch: 77, Training Loss: 0.0026, Validation Loss: 0.0037
2025-11-23 00:43:36,363 - INFO - Epoch: 78, Training Loss: 0.0034, Validation Loss: 0.0071
2025-11-23 00:43:43,427 - INFO - Epoch: 79, Training Loss: 0.0030, Validation Loss: 0.0035
2025-11-23 00:43:51,419 - INFO - Epoch: 80, Training Loss: 0.0028, Validation Loss: 0.0037
2025-11-23 00:44:00,210 - INFO - Epoch: 81, Training Loss: 0.0038, Validation Loss: 0.0032
2025-11-23 00:44:00,210 - INFO - Early stopping triggered at epoch 81
2025-11-23 00:44:00,210 - INFO - Best validation loss: 0.0031
2025-11-23 00:44:00,214 - INFO - Restored best model weights
2025-11-23 00:44:00,214 - INFO - Starting model save process...
2025-11-23 00:44:00,214 - INFO - Creating models directory: ./logs_fp_no_cv/models
2025-11-23 00:44:00,214 - INFO - Models directory created/verified: ./logs_fp_no_cv/models
2025-11-23 00:44:00,214 - INFO - Attempting to save model to: ./logs_fp_no_cv/models/trial12_best_model
2025-11-23 00:44:00,324 - WARNING - Failed to save model in SavedModel format: in user code:

    File "/home/vivian/miniconda3/envs/seed/lib/python3.8/site-packages/keras/src/saving/legacy/saving_utils.py", line 147, in _wrapped_model  *
        outputs = model(*args, **kwargs)
    File "/home/vivian/miniconda3/envs/seed/lib/python3.8/site-packages/keras/src/utils/traceback_utils.py", line 70, in error_handler  **
        raise e.with_traceback(filtered_tb) from None
    File "/tmp/__autograph_generated_file3t0ck_8q.py", line 10, in tf__call
        att1 = ag__.converted_call(ag__.ld(self).MHRSSA, (ag__.ld(x), 10), None, fscope)
    File "/tmp/__autograph_generated_file2szops_9.py", line 41, in tf__MHRSSA
        ag__.for_stmt(ag__.converted_call(ag__.ld(range), (ag__.ld(out_filter),), None, fscope), None, loop_body, get_state_1, set_state_1, ('MHRSSA',), {'iterate_names': 'i'})
    File "/tmp/__autograph_generated_file2szops_9.py", line 21, in loop_body
        tmp = ag__.converted_call(ag__.converted_call(ag__.ld(tf).keras.layers.Conv2D, (ag__.ld(num_channel), (ag__.ld(num_channel), 1)), dict(kernel_regularizer=ag__.ld(self).regularizer, activation=None), fscope), (ag__.ld(x),), None, fscope)

    ValueError: Exception encountered when calling layer 'vignet_fp_11' (type vignet_fp).
    
    in user code:
    
        File "/home/vivian/eeg/SEED_VIG/VIGNet/network_fp.py", line 56, in call  *
            att1 = self.MHRSSA(x, 10)
        File "/home/vivian/eeg/SEED_VIG/VIGNet/network_fp.py", line 44, in MHRSSA  *
            tmp = tf.keras.layers.Conv2D(num_channel, (num_channel, 1), kernel_regularizer=self.regularizer, activation=None)(x)
        File "/home/vivian/miniconda3/envs/seed/lib/python3.8/site-packages/keras/src/utils/traceback_utils.py", line 70, in error_handler  **
            raise e.with_traceback(filtered_tb) from None
    
        ValueError: tf.function only supports singleton tf.Variables created on the first call. Make sure the tf.Variable is only created once or created outside tf.function. See https://www.tensorflow.org/guide/function#creating_tfvariables for more information.
    
    
    Call arguments received by layer 'vignet_fp_11' (type vignet_fp):
      • x=tf.Tensor(shape=(None, 2, 25, 1), dtype=float64)
      • training=False

2025-11-23 00:44:00,324 - WARNING - Traceback (most recent call last):
  File "experiment_fp_no_cv.py", line 261, in _save_model
    model.save(model_save_path, save_format='tf')
  File "/home/vivian/miniconda3/envs/seed/lib/python3.8/site-packages/keras/src/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_fileu3w_yla6.py", line 14, in tf___wrapped_model
    outputs = ag__.converted_call(ag__.ld(model), tuple(ag__.ld(args)), dict(**ag__.ld(kwargs)), fscope)
  File "/tmp/__autograph_generated_file3t0ck_8q.py", line 10, in tf__call
    att1 = ag__.converted_call(ag__.ld(self).MHRSSA, (ag__.ld(x), 10), None, fscope)
  File "/tmp/__autograph_generated_file2szops_9.py", line 41, in tf__MHRSSA
    ag__.for_stmt(ag__.converted_call(ag__.ld(range), (ag__.ld(out_filter),), None, fscope), None, loop_body, get_state_1, set_state_1, ('MHRSSA',), {'iterate_names': 'i'})
  File "/tmp/__autograph_generated_file2szops_9.py", line 21, in loop_body
    tmp = ag__.converted_call(ag__.converted_call(ag__.ld(tf).keras.layers.Conv2D, (ag__.ld(num_channel), (ag__.ld(num_channel), 1)), dict(kernel_regularizer=ag__.ld(self).regularizer, activation=None), fscope), (ag__.ld(x),), None, fscope)
ValueError: in user code:

    File "/home/vivian/miniconda3/envs/seed/lib/python3.8/site-packages/keras/src/saving/legacy/saving_utils.py", line 147, in _wrapped_model  *
        outputs = model(*args, **kwargs)
    File "/home/vivian/miniconda3/envs/seed/lib/python3.8/site-packages/keras/src/utils/traceback_utils.py", line 70, in error_handler  **
        raise e.with_traceback(filtered_tb) from None
    File "/tmp/__autograph_generated_file3t0ck_8q.py", line 10, in tf__call
        att1 = ag__.converted_call(ag__.ld(self).MHRSSA, (ag__.ld(x), 10), None, fscope)
    File "/tmp/__autograph_generated_file2szops_9.py", line 41, in tf__MHRSSA
        ag__.for_stmt(ag__.converted_call(ag__.ld(range), (ag__.ld(out_filter),), None, fscope), None, loop_body, get_state_1, set_state_1, ('MHRSSA',), {'iterate_names': 'i'})
    File "/tmp/__autograph_generated_file2szops_9.py", line 21, in loop_body
        tmp = ag__.converted_call(ag__.converted_call(ag__.ld(tf).keras.layers.Conv2D, (ag__.ld(num_channel), (ag__.ld(num_channel), 1)), dict(kernel_regularizer=ag__.ld(self).regularizer, activation=None), fscope), (ag__.ld(x),), None, fscope)

    ValueError: Exception encountered when calling layer 'vignet_fp_11' (type vignet_fp).
    
    in user code:
    
        File "/home/vivian/eeg/SEED_VIG/VIGNet/network_fp.py", line 56, in call  *
            att1 = self.MHRSSA(x, 10)
        File "/home/vivian/eeg/SEED_VIG/VIGNet/network_fp.py", line 44, in MHRSSA  *
            tmp = tf.keras.layers.Conv2D(num_channel, (num_channel, 1), kernel_regularizer=self.regularizer, activation=None)(x)
        File "/home/vivian/miniconda3/envs/seed/lib/python3.8/site-packages/keras/src/utils/traceback_utils.py", line 70, in error_handler  **
            raise e.with_traceback(filtered_tb) from None
    
        ValueError: tf.function only supports singleton tf.Variables created on the first call. Make sure the tf.Variable is only created once or created outside tf.function. See https://www.tensorflow.org/guide/function#creating_tfvariables for more information.
    
    
    Call arguments received by layer 'vignet_fp_11' (type vignet_fp):
      • x=tf.Tensor(shape=(None, 2, 25, 1), dtype=float64)
      • training=False


2025-11-23 00:44:00,324 - INFO - Attempting to save model weights to: ./logs_fp_no_cv/models/trial12_best_weights.h5
2025-11-23 00:44:00,331 - INFO - ✓ Saved model weights to: ./logs_fp_no_cv/models/trial12_best_weights.h5
2025-11-23 00:44:00,331 - INFO - Attempting to save scaler to: ./logs_fp_no_cv/models/trial12_scaler.pkl
2025-11-23 00:44:00,331 - INFO - ✓ Saved scaler to: ./logs_fp_no_cv/models/trial12_scaler.pkl
2025-11-23 00:44:00,331 - INFO - Attempting to save metadata to: ./logs_fp_no_cv/models/trial12_metadata.pkl
2025-11-23 00:44:00,331 - INFO - ✓ Saved model metadata to: ./logs_fp_no_cv/models/trial12_metadata.pkl
2025-11-23 00:44:00,331 - INFO - Model save process completed
2025-11-23 00:44:00,331 - INFO - 
============================================================
2025-11-23 00:44:00,331 - INFO - EVALUATION RESULTS
2025-11-23 00:44:00,331 - INFO - ============================================================
2025-11-23 00:44:00,380 - INFO - Validation Prediction Stats:
2025-11-23 00:44:00,380 - INFO -   Std: 0.367127, Range: 0.925024, Unique ratio: 0.6565
2025-11-23 00:44:00,381 - INFO - Validation Set - MSE: 0.003220, MAE: 0.039772, RMSE: 0.056748, Pearson Correlation: 0.989066 (p=0.000000)
2025-11-23 00:44:00,492 - INFO - Test Prediction Stats:
2025-11-23 00:44:00,492 - INFO -   Std: 0.369972, Range: 0.928197, Unique ratio: 0.6912
2025-11-23 00:44:00,493 - INFO - Test Set - MSE: 0.003397, MAE: 0.043667, RMSE: 0.058282, Pearson Correlation: 0.988498 (p=0.000000)
2025-11-23 00:44:00,494 - INFO - ============================================================

2025-11-23 00:44:00,495 - INFO - Trial completed successfully
2025-11-23 00:44:00,495 - INFO - ================================================================================
2025-11-23 00:44:00,495 - INFO - Trial 12 completed. End time: 2025-11-23 00:44:00
2025-11-23 00:44:00,495 - INFO - ================================================================================
